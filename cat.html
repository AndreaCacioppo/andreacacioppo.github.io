<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>cat</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    background: #0d1210;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    overflow: hidden;
    cursor: crosshair;
  }
  #cat {
    font-family: 'Courier New', Courier, monospace;
    font-size: min(14px, 2.2vw);
    line-height: 1.2;
    color: #4a9e4a;
    white-space: pre;
    user-select: none;
  }

  .van-link {
    position: fixed;
    top: 2rem;
    right: 2rem;
    padding: 0.45rem 0.7rem;
    border-radius: 999px;
    background: rgba(5, 12, 8, 0.7);
    border: 1px solid rgba(74, 158, 74, 0.15);
    color: rgba(74, 158, 74, 0.65);
    text-decoration: none;
    transition: color 200ms ease, border-color 200ms ease, transform 200ms ease;
    backdrop-filter: blur(5px);
    z-index: 10;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .van-link:hover,
  .van-link:focus-visible {
    color: rgba(74, 158, 74, 0.95);
    border-color: rgba(74, 158, 74, 0.4);
    transform: translateY(-2px);
    outline: none;
  }

  .van-link:hover svg {
    filter: drop-shadow(0 0 6px rgba(180, 180, 100, 0.5));
  }

  .van-link:active {
    transform: translateY(0);
  }

  .van-link svg {
    width: 22px;
    height: 22px;
    fill: none;
    stroke: currentColor;
    stroke-linecap: round;
    stroke-linejoin: round;
    animation: spin-star 12s linear infinite;
  }

  @keyframes spin-star {
    from { transform: rotate(0deg); }
    to   { transform: rotate(360deg); }
  }

  .back-link {
    position: fixed;
    top: 2rem;
    left: 2rem;
    padding: 0.45rem 0.7rem;
    border-radius: 999px;
    background: rgba(5, 12, 8, 0.7);
    border: 1px solid rgba(74, 158, 74, 0.15);
    color: rgba(74, 158, 74, 0.65);
    text-decoration: none;
    transition: color 200ms ease, border-color 200ms ease, transform 200ms ease;
    backdrop-filter: blur(5px);
    z-index: 10;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .back-link:hover,
  .back-link:focus-visible {
    color: rgba(74, 158, 74, 0.95);
    border-color: rgba(74, 158, 74, 0.4);
    transform: translateY(-2px);
    outline: none;
  }

  .back-link:hover svg {
    filter: drop-shadow(0 0 4px rgba(74, 158, 74, 0.5));
  }

  .back-link:active {
    transform: translateY(0);
  }

  .back-link svg {
    width: 20px;
    height: 20px;
    fill: none;
    stroke: currentColor;
    stroke-width: 1.6;
    stroke-linecap: round;
    stroke-linejoin: round;
    transition: filter 200ms ease;
  }

  @media (max-width: 600px) {
    .van-link {
      top: 1.2rem;
      right: 1.2rem;
    }
    .back-link {
      top: 1.2rem;
      left: 1.2rem;
    }
  }
</style>
</head>
<body>
<a class="back-link" href="/ads.html" aria-label="return to ads page">
  <svg viewBox="0 0 24 24">
    <rect x="8" y="3" width="8" height="18" rx="4"/>
    <line x1="8" y1="12" x2="16" y2="12"/>
  </svg>
</a>
<a class="van-link" href="/van.html" aria-label="starry night">
  <svg viewBox="0 0 24 24">
    <!-- inner glow -->
    <circle cx="12" cy="12" r="3" stroke-width="1.6"/>
    <!-- swirl halo ring -->
    <circle cx="12" cy="12" r="6.5" stroke-width="0.9" stroke-dasharray="3.5 2.5" stroke-dashoffset="1"/>
    <!-- outer swirl ring -->
    <circle cx="12" cy="12" r="10" stroke-width="0.7" stroke-dasharray="4 3.5" stroke-dashoffset="3"/>
    <!-- radiating brush wisps -->
    <path d="M12 1.5 C12.3 4, 11.7 4, 12 5" stroke-width="0.8"/>
    <path d="M12 22.5 C11.7 20, 12.3 20, 12 19" stroke-width="0.8"/>
    <path d="M1.5 12 C4 12.3, 4 11.7, 5 12" stroke-width="0.8"/>
    <path d="M22.5 12 C20 11.7, 20 12.3, 19 12" stroke-width="0.8"/>
    <path d="M4.2 4.2 C5.5 5.8, 6 5.3, 6.8 6.8" stroke-width="0.7"/>
    <path d="M19.8 4.2 C18.5 5.8, 18 5.3, 17.2 6.8" stroke-width="0.7"/>
    <path d="M4.2 19.8 C5.5 18.2, 6 18.7, 6.8 17.2" stroke-width="0.7"/>
    <path d="M19.8 19.8 C18.5 18.2, 18 18.7, 17.2 17.2" stroke-width="0.7"/>
  </svg>
</a>
<pre id="cat"></pre>

<script>
const catEl = document.getElementById('cat');
let mouseX = window.innerWidth / 2;
let mouseY = window.innerHeight / 2;
let blinking = false;

// ─── Smooth gaze ───
let currentGX = 0, currentGY = 0;
const LERP = 0.06;

// ─── Eye parameters ───
const EYE_W = 30, EYE_H = 10, RX = 14, RY = 4.5;
const GAP = '      ';
const TOTAL_W = EYE_W + GAP.length + EYE_W; // 66
const CENTER = TOTAL_W / 2; // 33

const TIER = [
  ['%','%','%','%','%','%','%'],
  ['%','%','X','%','=','%','0'],
  ['%','=','X','+','0','%','='],
  ['=','+','~','X','0','=','+'],
  ['~','~','+','=','~','0','~'],
];
const BORDER = ['·','0','=','·','X','·','0'];

function charAt(pool, r, c) {
  return pool[((r * 37 + c * 13 + 7) & 0x7FFFFFFF) % pool.length];
}

function buildEye(gazeX, gazeY) {
  const cx = EYE_W / 2, cy = EYE_H / 2;
  const fx = cx + gazeX * 3.5, fy = cy + gazeY * 1.0;
  const slitX = fx, slitCY = cy + gazeY * 1.8;
  const grid = [];
  for (let r = 0; r < EYE_H; r++) {
    let row = '';
    for (let c = 0; c < EYE_W; c++) {
      const ex = (c - cx) / RX, ey = (r - cy) / RY;
      const eDist = ex * ex + ey * ey;
      if (eDist > 1.15) { row += ' '; continue; }
      if (eDist > 0.88) { row += charAt(BORDER, r, c); continue; }
      const slitRowDist = Math.abs(r - slitCY);
      const slitHalfH = 2.8;
      if (slitRowDist < slitHalfH) {
        const slitNorm = slitRowDist / slitHalfH;
        const slitHalfW = 1.2 * (1.0 - slitNorm * 0.85);
        const distToSlit = Math.abs(c - slitX);
        if (distToSlit < slitHalfW) { row += ' '; continue; }
        if (distToSlit < slitHalfW + 0.8) {
          row += ['|','¦','│'][(r * 7 + c * 3) % 3]; continue;
        }
      }
      const dx = c - fx, dy = (r - fy) * 2.2;
      const fDist = Math.sqrt(dx * dx + dy * dy);
      const tier = fDist < 3 ? 0 : fDist < 5.5 ? 1 : fDist < 8 ? 2 : fDist < 11 ? 3 : 4;
      row += charAt(TIER[tier], r, c);
    }
    grid.push(row);
  }
  return grid;
}

function buildBlinkEye() {
  const cx = EYE_W / 2, cy = EYE_H / 2;
  const grid = [];
  for (let r = 0; r < EYE_H; r++) {
    let row = '';
    for (let c = 0; c < EYE_W; c++) {
      const ex = (c - cx) / RX, ey = (r - cy) / RY;
      const eDist = ex * ex + ey * ey;
      if (eDist > 1.15) { row += ' '; continue; }
      if (r >= Math.floor(cy) - 0.5 && r <= Math.ceil(cy) + 0.5) {
        row += eDist < 1.0 ? ['=','~','─','=','~'][(c * 11 + 3) % 5] : '·';
      } else { row += ' '; }
    }
    grid.push(row);
  }
  return grid;
}

function centerLine(text) {
  const pad = Math.max(0, Math.floor(CENTER - text.length / 2));
  return ' '.repeat(pad) + text;
}

function getTargetGaze() {
  const cx = window.innerWidth / 2, cy = window.innerHeight / 2;
  const dx = mouseX - cx, dy = mouseY - cy;
  const dist = Math.sqrt(dx * dx + dy * dy);
  if (dist < 30) return { gx: 0, gy: 0 };
  const t = Math.min(dist / 400, 1);
  return {
    gx: (dx / (Math.abs(dx) || 1)) * t,
    gy: (dy / (Math.abs(dy) || 1)) * t * 0.5,
  };
}

function colorize(line) {
  let out = '';
  for (const ch of line) {
    switch (ch) {
      case '·': out += `<span style="color:#254a25">${ch}</span>`; break;
      case '%': out += `<span style="color:#5cb85c">${ch}</span>`; break;
      case '~': out += `<span style="color:#3d8b3d">${ch}</span>`; break;
      case '=': case 'X': case 'x':
        out += `<span style="color:#4aa04a">${ch}</span>`; break;
      case '0': case 'O':
        out += `<span style="color:#3d8b3d">${ch}</span>`; break;
      case '+': case ';':
        out += `<span style="color:#398039">${ch}</span>`; break;
      case '-': case '─':
        out += `<span style="color:#2d602d">${ch}</span>`; break;
      case '|': case '¦': case '│':
        out += `<span style="color:#1a3518">${ch}</span>`; break;
      default: out += ch;
    }
  }
  return out;
}

function render() {
  const le = blinking ? buildBlinkEye() : buildEye(currentGX, currentGY);
  const re = blinking ? buildBlinkEye() : buildEye(currentGX, currentGY);
  const lines = [];
  for (let r = 0; r < EYE_H; r++) {
    const row = le[r].padEnd(EYE_W) + GAP + re[r];
    lines.push(row.padEnd(TOTAL_W));
  }
  lines.push('');
  lines.push(centerLine('·~~~~·  ·~~~~·').padEnd(TOTAL_W));
  lines.push(centerLine('·~~~~·~~~~·').padEnd(TOTAL_W));
  lines.push(centerLine('=%%%%x').padEnd(TOTAL_W));
  lines.push(centerLine('=%%;~').padEnd(TOTAL_W));
  lines.push(centerLine('~~%%x~~····=%;=X=;%=····~~x%%~~').padEnd(TOTAL_W));
  lines.push(centerLine('~XX==X~~·          ·~~X==XX~').padEnd(TOTAL_W));
  lines.push(centerLine('·~~~·              ·~~~·').padEnd(TOTAL_W));
  catEl.innerHTML = lines.map(colorize).join('\n');
}

function tick() {
  const t = getTargetGaze();
  currentGX += (t.gx - currentGX) * LERP;
  currentGY += (t.gy - currentGY) * LERP;
  render();
  requestAnimationFrame(tick);
}

function scheduleBlink() {
  setTimeout(() => {
    blinking = true;
    setTimeout(() => { blinking = false; scheduleBlink(); }, 130);
  }, 2500 + Math.random() * 4000);
}

document.addEventListener('mousemove', e => { mouseX = e.clientX; mouseY = e.clientY; });
document.addEventListener('touchstart', e => { mouseX = e.touches[0].clientX; mouseY = e.touches[0].clientY; }, { passive: true });
document.addEventListener('touchmove', e => { mouseX = e.touches[0].clientX; mouseY = e.touches[0].clientY; }, { passive: true });
requestAnimationFrame(tick);
scheduleBlink();
</script>
</body>
</html>
